parameters:
    kernel.secret: ~

services:
    _defaults:
        autowire: true
        autoconfigure: true

    App\:
        resource: '../src/*'
        exclude: '../src/{Kernel.php}'

    Psr\Container\ContainerInterface:
        synthetic: true

    # TWITTER
    HeadlessChromium\BrowserFactory:
        arguments: ['chromium-browser']

    HeadlessChromium\Browser:
        factory: ['@HeadlessChromium\BrowserFactory', 'createBrowser']
#        arguments: [headless: false]

    App\Twitter\Browser\Client:
        arguments:
            $headersInterceptorScript: '%root_dir%/src/Twitter/Browser/Resource/headers-interceptor.js'
            $requestProxyScript: '%root_dir%/src/Twitter/Browser/Resource/request-proxy.js'

    App\Twitter\Task\Task:
        shared: false
        public: true
        arguments:
            $sources:
                search: '@App\Twitter\Task\Source\Search'
            $actions:
                favorite: '@App\Twitter\Task\Actions\Tweet\Favorite'
                friendship_mentioned: '@App\Twitter\Task\Actions\Tweet\FriendshipMentioned'
                friendship_owner: '@App\Twitter\Task\Actions\Tweet\FriendshipOwner'
                reply: '@App\Twitter\Task\Actions\Tweet\Reply'
                retweet: '@App\Twitter\Task\Actions\Tweet\Retweet'
                retrieve_original_tweet: '@App\Twitter\Task\Actions\Tweet\RetrieveOriginalTweet'
                display: '@App\Twitter\Task\Actions\Tweet\Display'
                reload: '@App\Twitter\Task\Actions\Tweet\Reload'
            $conditions:
                field_comparison: '@App\Twitter\Task\Conditions\FieldComparison'
                field_match: '@App\Twitter\Task\Conditions\FieldMatch'
                is_unique: '@App\Twitter\Task\Conditions\IsUnique'

    # CONFIGURATION
    Symfony\Component\Yaml\Parser: ~

    Symfony\Component\Serializer\Encoder\YamlEncoder:
        arguments:
            $defaultContext: { yaml_inline: 10 }

    Symfony\Component\Serializer\SerializerInterface: '@Symfony\Component\Serializer\Serializer'

    Symfony\Component\Serializer\Serializer:
        arguments:
            $encoders: ['@Symfony\Component\Serializer\Encoder\YamlEncoder']

    App\Configuration\Configuration:
        arguments:
            $defaultConfigFile: '%root_dir%/config/default.yaml'
            $parser: '@Symfony\Component\Yaml\Parser'
        calls:
            - ['load']

    # CONSOLE
    Psr\Log\LoggerInterface: '@App\Console\Logger\ConsoleLogger'

    App\Console\Logger\ConsoleLogger: ~

    Symfony\Component\Console\Input\ArgvInput: ~
    Symfony\Component\Console\Input\InputInterface:
        alias: 'Symfony\Component\Console\Input\ArgvInput'
        public: true

    Symfony\Component\Console\Output\ConsoleOutput:
        arguments:
            $verbosity: !php/const Symfony\Component\Console\Output\OutputInterface::VERBOSITY_VERY_VERBOSE
    Symfony\Component\Console\Output\OutputInterface:
        alias: 'Symfony\Component\Console\Output\ConsoleOutput'
        public: true

    Symfony\Component\Console\Style\SymfonyStyle: ~

    Symfony\Component\Console\Application:
        calls:
            - ['add', ['@App\Console\Command\TwitterCommand']]
            - ['add', ['@App\Console\Command\LegacyCommand']]
            - ['setDefaultCommand', [!php/const App\Console\Command\TwitterCommand::COMMAND_NAME, false]]
        public: true
